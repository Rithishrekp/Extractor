<!DOCTYPE html>
<html>
<head>
    <title>Smart Multilingual Document Extractor & Classifier</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            background-color: #f2f2f2;
        }
        h1 { text-align: center; color: #2c3e50; }

        form {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            max-width: 600px;
            margin: 0 auto 30px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        input[type=file], input[type=submit], select {
            width: 100%;
            padding: 12px;
            margin: 8px 0 16px;
        }

        .result-box {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            max-width: 900px;
            margin: 0 auto 30px;
            box-shadow: 0 0 8px rgba(0,0,0,0.1);
        }

        .result-box h2 { color: #2980b9; }
        pre {
            background: #f9f9f9;
            padding: 10px;
            white-space: pre-wrap;
            border-left: 4px solid #3498db;
        }

        .field-detected {
            font-weight: bold;
            color: green;
        }

        .keyword-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .keyword-list li {
            display: inline-block;
            background: tan;
            padding: 6px 12px;
            margin: 4px;
            border-radius: 20px;
            font-weight: bold;
        }

        .keyword-group { margin-bottom: 15px; }
        .keyword-group h3 { color: #c0392b; }

        /* AUTH (hidden) */
        .auth-container {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        .auth-card {
            background: white;
            padding: 35px;
            width: 360px;
            border-radius: 15px;
        }
    </style>
</head>

<body>

<h1>ğŸ“„ Smart Document Extractor & Field Identifier</h1>

<form method="post" enctype="multipart/form-data">
    <label><strong>Select a document:</strong></label>
    <input type="file" name="document" accept=".pdf,.docx,.txt,.png,.jpg,.jpeg" required>

    <label><strong>Select target language:</strong></label>
    <select name="lang">
        <option value="en" {% if target_lang=='en' %}selected{% endif %}>English</option>
        <option value="hi" {% if target_lang=='hi' %}selected{% endif %}>Hindi</option>
        <option value="ta" {% if target_lang=='ta' %}selected{% endif %}>Tamil</option>
        <option value="te" {% if target_lang=='te' %}selected{% endif %}>Telugu</option>
        <option value="kn" {% if target_lang=='kn' %}selected{% endif %}>Kannada</option>
        <option value="ml" {% if target_lang=='ml' %}selected{% endif %}>Malayalam</option>
        <option value="mr" {% if target_lang=='mr' %}selected{% endif %}>Marathi</option>
        <option value="bn" {% if target_lang=='bn' %}selected{% endif %}>Bengali</option>
        <option value="gu" {% if target_lang=='gu' %}selected{% endif %}>Gujarati</option>
        <option value="pa" {% if target_lang=='pa' %}selected{% endif %}>Punjabi</option>
        <option value="ur" {% if target_lang=='ur' %}selected{% endif %}>Urdu</option>
        <option value="fr" {% if target_lang=='fr' %}selected{% endif %}>French</option>
        <option value="de" {% if target_lang=='de' %}selected{% endif %}>German</option>
        <option value="es" {% if target_lang=='es' %}selected{% endif %}>Spanish</option>
        <option value="zh-cn" {% if target_lang=='zh-cn' %}selected{% endif %}>Chinese (Simplified)</option>
        <option value="ja" {% if target_lang=='ja' %}selected{% endif %}>Japanese</option>
    </select>

    <input type="submit" value="Upload & Analyze">
</form>

{% if detected_field %}
<div class="result-box">
    <h2>ğŸ§  Detected Field:
        <span class="field-detected">{{ detected_field }}</span>
    </h2>
</div>
{% endif %}

{% if extracted %}
<div class="result-box">
    <h2>ğŸ”‘ Extracted Keywords</h2>
    {% for group, items in extracted.items() %}
        {% if items %}
        <div class="keyword-group">
            <h3>{{ group }}</h3>
            <ul class="keyword-list">
                {% for item in items %}
                    <li>{{ item }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    {% endfor %}
</div>
{% endif %}

{% if translated_keywords %}
<div class="result-box">
    <h2>ğŸŒ Translated Keywords ({{ target_lang }})</h2>
    {% for group, items in translated_keywords.items() %}
        {% if items %}
        <div class="keyword-group">
            <h3>{{ group }}</h3>
            <ul class="keyword-list">
                {% for item in items %}
                    <li>{{ item }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    {% endfor %}
</div>
{% endif %}

{% if ex_summary %}
<div class="result-box">
    <h2>ğŸ“ Extractive Summary</h2>
    <pre>{{ ex_summary }}</pre>
</div>
{% endif %}

{% if translated_ex_summary and target_lang != 'en' %}
<div class="result-box">
    <h2>ğŸŒ Translated Summary</h2>
    <pre>{{ translated_ex_summary }}</pre>
</div>
{% endif %}

{% if full_text %}
<div class="result-box">
    <h2>ğŸ“œ Extracted Text</h2>
    <pre>{{ full_text }}</pre>
</div>
{% endif %}

{% if translated_text and target_lang != 'en' %}
<div class="result-box">
    <h2>ğŸŒ Translated Text</h2>
    <pre>{{ translated_text }}</pre>
</div>
{% endif %}

{% if receipt_fields %}
<div class="result-box">
    <h2>ğŸ§¾ Receipt Details</h2>
    {% for k, v in receipt_fields.items() %}
        <p><strong>{{ k }}:</strong> {{ v }}</p>
    {% endfor %}
</div>
{% endif %}

{% if audio_combined %}
<div class="result-box">
    <h2>ğŸ§ Full Narration</h2>
    <audio controls>
        <source src="{{ url_for('static', filename=audio_combined) }}" type="audio/mpeg">
    </audio>
</div>
{% endif %}

{% if uploaded_files %}
<div class="result-box">
    <h2>ğŸ“‚ Your Uploaded Files</h2>
    <ul>
        {% for file in uploaded_files %}
            <li>
                <a href="{{ url_for('myfile', filename=file) }}">{{ file }}</a>
            </li>
        {% endfor %}
    </ul>
</div>
{% endif %}

</body>
</html>
